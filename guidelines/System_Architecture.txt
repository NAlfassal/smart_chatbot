â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Frontend                      â”‚
â”‚              (Gradio UI)                       â”‚
â”‚                                                â”‚
â”‚  [Text Input: Ø§Ù„Ø³Ø¤Ø§Ù„]                         â”‚
â”‚  [â˜] Ø§Ù„Ù„ÙˆØ§Ø¦Ø­ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©                        â”‚
â”‚  [â˜] Ø£Ø³Ø³ Ø§Ù„ØªØ®Ø²ÙŠÙ† ÙˆØ§Ù„ØªÙˆØ²ÙŠØ¹                     â”‚
â”‚  [â˜] Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©                          â”‚
â”‚  [â˜] ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© (Web Search)               â”‚
â”‚  [â˜] ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© (Web Search)               â”‚
â”‚  [â˜‘] Ø¬Ù…ÙŠØ¹ Ù…Ø§ Ø³Ø¨Ù‚ (Default)                   â”‚
â”‚                                                â”‚
â”‚  [Send Button]                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Query Router ğŸ§                    â”‚
â”‚  (Intelligent query classification)           â”‚
â”‚                                                â”‚
â”‚  def classify_query(text, selected_sources):  â”‚
â”‚      if is_registration_number(text):         â”‚
â”‚          return "agent"                        â”‚
â”‚      else:                                     â”‚
â”‚          return "rag"                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        â†“               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Agent      â”‚  â”‚   RAG        â”‚
â”‚   System     â”‚  â”‚   System     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                 â”‚
       â†“                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Unified Cache Layer ğŸ’¾             â”‚
â”‚  (Redis-like in-memory dict)                 â”‚
â”‚                                               â”‚
â”‚  cache = {                                    â”‚
â”‚    "query_hash": {                            â”‚
â”‚        "response": "...",                     â”‚
â”‚        "source": "agent/rag",                 â”‚
â”‚        "timestamp": "...",                    â”‚
â”‚    }                                          â”‚
â”‚  }                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜